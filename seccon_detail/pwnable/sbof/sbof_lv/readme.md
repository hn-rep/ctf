#■概要
  ・スタックバッファーオーバーフローを利用したローカル変数の書き換え
  ・code 32-9～32-11

#■実行方法
    $ stdbuf -o0 -e0 python3 ./sbof_lv.py

#■対象ソースコード
  ・sbof_lv.c

#■脆弱性
  ・標準入力で、ローカル変数 name に書き込みするとき、スタックバッファーオーバーフローが発生する。

#■スタックのメモリ配置
            ┌───────────────────────┐
    -0x30   │                    name                      │
            ├───────────────────────┤
    -0x20   │                    secret                    │
            ├─────┬─────┬───────────┤
    -0x10   │          │    key   │        priv          │
            ├─────┴─────┼───────────┤
    rbp     │    saved rbp         │    return address    │
            └───────────┴───────────┘

#■スタックのメモリ書き換え
            ┌───────────────────────┐
    -0x30   │                 'a' * 0x10                   │
            ├───────────────────────┤
    -0x20   │            'H4cked!'    '\x00'* 9            │
            ├─────┬─────┬───────────┤
    -0x10   │0x00000000│0xdeadbeef│    0x0000000040204b  │
            ├─────┴─────┼───────────┤
    rbp     │    saved rbp         │    return address    │
            └───────────┴───────────┘
